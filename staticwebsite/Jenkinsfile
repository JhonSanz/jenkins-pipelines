pipeline {
  agent {
    docker {
      image 'node:18'
    }
  }
  stages {
    stage('Compile and build') {
      steps {
        git branch: "master", url: "https://github.com/JhonSanz/pythonandfamily_web"
        echo 'clone ok'
        sh 'pwd'
        dir("pythonandfamily_web") {
          echo 'Changed to directory:'
          sh 'pwd'
          sh 'npm install'
          sh 'npm run build'
          sh ls
        }
      }
    }
    // stage('Despliegue a AWS S3') {
    //   steps {
    //     script {
    //         def awsAccessKeyId = credentials('aws_access_key_id')
    //         def awsSecretKey = credentials('aws_secret_access_key')

    //         withAWS(region: 'tu_region', credentials: [
    //           awsAccessKeyId: awsAccessKeyId,
    //           awsSecretKey: awsSecretKey
    //         ]) {
    //           s3Upload(file: "pythonandfamily_web/build/index.html", bucket: "test-jenkins-staticwebsite", path: "/")
    //         }
    //     }
    //   }
    // }
  }
}

